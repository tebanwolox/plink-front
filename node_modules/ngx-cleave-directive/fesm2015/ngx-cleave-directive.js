import { Directive, ElementRef, HostListener, Inject, Input, Optional, NgModule } from '@angular/core';
import { NG_VALUE_ACCESSOR } from '@angular/forms';
import * as Cleave from 'cleave.js';

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */
class NgxCleaveDirective {
    /**
     * @param {?} elementRef
     * @param {?} valueAccessors
     */
    constructor(elementRef, valueAccessors) {
        this.elementRef = elementRef;
        this.valueAccessors = valueAccessors;
    }
    /**
     * @param {?} cleave
     * @return {?}
     */
    set cleave(cleave) {
        this._cleave = cleave;
        this.setCleave();
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        if (!this.valueAccessors) {
            console.warn('Note: The cleave directive should be used with the ngModel, formControl or formControlName directives.');
            return;
        }
        if (this.valueAccessors.length) {
            this._valueAccessor = this.valueAccessors[0];
            this._writeValue = this._valueAccessor.writeValue;
            this._valueAccessor.writeValue = (value) => {
                if (this._writeValue) {
                    this._writeValue.call(this._valueAccessor, value);
                }
                this.setCleave();
            };
        }
    }
    /**
     * @return {?}
     */
    ngOnDestroy() {
        if (this._valueAccessor && this._writeValue) {
            this._valueAccessor.writeValue = this._writeValue;
        }
        if (this._cleaveInstance) {
            this._cleaveInstance.destroy();
        }
    }
    /**
     * @param {?} value
     * @return {?}
     */
    onInput(value) {
        this._value = value;
    }
    /**
     * @return {?}
     */
    setCleave() {
        if (this._cleaveInstance) {
            this._cleaveInstance.destroy();
        }
        const /** @type {?} */ el = this.elementRef.nativeElement;
        this._cleaveInstance = new Cleave(el, Object.assign({}, this._cleave, { onValueChanged: ({ target }) => {
                if (target.value !== this._value) {
                    this.dispatchEvent(el, 'input');
                }
            } }));
        // hack for model -> view cleave
        setTimeout(() => this.dispatchEvent(el, 'input'), 0);
    }
    /**
     * @param {?} el
     * @param {?} eventType
     * @return {?}
     */
    dispatchEvent(el, eventType) {
        const /** @type {?} */ event = document.createEvent('Event');
        event.initEvent(eventType, false, false);
        el.dispatchEvent(event);
    }
}
NgxCleaveDirective.decorators = [
    { type: Directive, args: [{
                selector: 'input[cleave],textarea[cleave]',
            },] },
];
/** @nocollapse */
NgxCleaveDirective.ctorParameters = () => [
    { type: ElementRef, },
    { type: Array, decorators: [{ type: Inject, args: [NG_VALUE_ACCESSOR,] }, { type: Optional },] },
];
NgxCleaveDirective.propDecorators = {
    "cleave": [{ type: Input },],
    "onInput": [{ type: HostListener, args: ['input', ['$event.target.value'],] },],
};

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */
class NgxCleaveDirectiveModule {
}
NgxCleaveDirectiveModule.decorators = [
    { type: NgModule, args: [{
                imports: [],
                declarations: [NgxCleaveDirective],
                exports: [NgxCleaveDirective],
            },] },
];

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */

export { NgxCleaveDirective, NgxCleaveDirectiveModule };

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmd4LWNsZWF2ZS1kaXJlY3RpdmUuanMubWFwIiwic291cmNlcyI6WyJuZzovL25neC1jbGVhdmUtZGlyZWN0aXZlL25neC1jbGVhdmUuZGlyZWN0aXZlLnRzIiwibmc6Ly9uZ3gtY2xlYXZlLWRpcmVjdGl2ZS9uZ3gtY2xlYXZlLWRpcmVjdGl2ZS5tb2R1bGUudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgRGlyZWN0aXZlLFxuICBFbGVtZW50UmVmLFxuICBIb3N0TGlzdGVuZXIsXG4gIEluamVjdCxcbiAgSW5wdXQsXG4gIE9uRGVzdHJveSxcbiAgT25Jbml0LFxuICBPcHRpb25hbCxcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQge1xuICBDb250cm9sVmFsdWVBY2Nlc3NvcixcbiAgTkdfVkFMVUVfQUNDRVNTT1IsXG59IGZyb20gJ0Bhbmd1bGFyL2Zvcm1zJztcblxuaW1wb3J0ICogYXMgQ2xlYXZlIGZyb20gJ2NsZWF2ZS5qcyc7XG5cbkBEaXJlY3RpdmUoe1xuICBzZWxlY3RvcjogJ2lucHV0W2NsZWF2ZV0sdGV4dGFyZWFbY2xlYXZlXScsXG59KVxuZXhwb3J0IGNsYXNzIE5neENsZWF2ZURpcmVjdGl2ZSBpbXBsZW1lbnRzIE9uSW5pdCwgT25EZXN0cm95IHtcblxuICBASW5wdXQoKSBzZXQgY2xlYXZlIChjbGVhdmU6IGFueSkge1xuXG4gICAgdGhpcy5fY2xlYXZlID0gY2xlYXZlO1xuXG4gICAgdGhpcy5zZXRDbGVhdmUoKTtcblxuICB9XG5cbiAgcHJpdmF0ZSBfY2xlYXZlOiBhbnk7XG4gIHByaXZhdGUgX2NsZWF2ZUluc3RhbmNlOiBDbGVhdmU7XG4gIHByaXZhdGUgX3ZhbHVlOiBzdHJpbmc7XG4gIHByaXZhdGUgX3ZhbHVlQWNjZXNzb3I6IENvbnRyb2xWYWx1ZUFjY2Vzc29yO1xuICBwcml2YXRlIF93cml0ZVZhbHVlOiAodmFsdWUpID0+IHZvaWQ7XG5cbiAgY29uc3RydWN0b3IgKFxuICAgIHByaXZhdGUgZWxlbWVudFJlZjogRWxlbWVudFJlZixcbiAgICBASW5qZWN0KE5HX1ZBTFVFX0FDQ0VTU09SKSBAT3B0aW9uYWwoKSBwcml2YXRlIHZhbHVlQWNjZXNzb3JzOiBDb250cm9sVmFsdWVBY2Nlc3NvcltdLFxuICApIHtcbiAgfVxuXG4gIG5nT25Jbml0ICgpIHtcblxuICAgIGlmICghdGhpcy52YWx1ZUFjY2Vzc29ycykge1xuXG4gICAgICBjb25zb2xlLndhcm4oJ05vdGU6IFRoZSBjbGVhdmUgZGlyZWN0aXZlIHNob3VsZCBiZSB1c2VkIHdpdGggdGhlIG5nTW9kZWwsIGZvcm1Db250cm9sIG9yIGZvcm1Db250cm9sTmFtZSBkaXJlY3RpdmVzLicpO1xuXG4gICAgICByZXR1cm47XG5cbiAgICB9XG5cbiAgICBpZiAodGhpcy52YWx1ZUFjY2Vzc29ycy5sZW5ndGgpIHtcblxuICAgICAgdGhpcy5fdmFsdWVBY2Nlc3NvciA9IHRoaXMudmFsdWVBY2Nlc3NvcnNbMF07XG5cbiAgICAgIHRoaXMuX3dyaXRlVmFsdWUgPSB0aGlzLl92YWx1ZUFjY2Vzc29yLndyaXRlVmFsdWU7XG4gICAgICB0aGlzLl92YWx1ZUFjY2Vzc29yLndyaXRlVmFsdWUgPSAodmFsdWUpID0+IHtcblxuICAgICAgICBpZiAodGhpcy5fd3JpdGVWYWx1ZSkge1xuICAgICAgICAgIHRoaXMuX3dyaXRlVmFsdWUuY2FsbCh0aGlzLl92YWx1ZUFjY2Vzc29yLCB2YWx1ZSk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnNldENsZWF2ZSgpO1xuXG4gICAgICB9O1xuXG4gICAgfVxuXG4gIH1cblxuICBuZ09uRGVzdHJveSAoKSB7XG5cbiAgICBpZiAodGhpcy5fdmFsdWVBY2Nlc3NvciAmJiB0aGlzLl93cml0ZVZhbHVlKSB7XG5cbiAgICAgIHRoaXMuX3ZhbHVlQWNjZXNzb3Iud3JpdGVWYWx1ZSA9IHRoaXMuX3dyaXRlVmFsdWU7XG5cbiAgICB9XG5cbiAgICBpZiAodGhpcy5fY2xlYXZlSW5zdGFuY2UpIHtcblxuICAgICAgdGhpcy5fY2xlYXZlSW5zdGFuY2UuZGVzdHJveSgpO1xuXG4gICAgfVxuXG4gIH1cblxuICBASG9zdExpc3RlbmVyKCdpbnB1dCcsIFsnJGV2ZW50LnRhcmdldC52YWx1ZSddKVxuICBvbklucHV0ICh2YWx1ZTogc3RyaW5nKTogdm9pZCB7XG5cbiAgICB0aGlzLl92YWx1ZSA9IHZhbHVlO1xuXG4gIH1cblxuICBwcml2YXRlIHNldENsZWF2ZSAoKSB7XG5cbiAgICBpZiAodGhpcy5fY2xlYXZlSW5zdGFuY2UpIHtcblxuICAgICAgdGhpcy5fY2xlYXZlSW5zdGFuY2UuZGVzdHJveSgpO1xuXG4gICAgfVxuXG4gICAgY29uc3QgZWwgPSB0aGlzLmVsZW1lbnRSZWYubmF0aXZlRWxlbWVudDtcbiAgICB0aGlzLl9jbGVhdmVJbnN0YW5jZSA9IG5ldyBDbGVhdmUoZWwsIHtcbiAgICAgIC4uLnRoaXMuX2NsZWF2ZSxcbiAgICAgIG9uVmFsdWVDaGFuZ2VkOiAoeyB0YXJnZXQgfSkgPT4ge1xuICAgICAgICBpZiAodGFyZ2V0LnZhbHVlICE9PSB0aGlzLl92YWx1ZSkge1xuXG4gICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KGVsLCAnaW5wdXQnKTtcblxuICAgICAgICB9XG4gICAgICB9LFxuICAgIH0pO1xuXG4gICAgLy8gaGFjayBmb3IgbW9kZWwgLT4gdmlldyBjbGVhdmVcbiAgICBzZXRUaW1lb3V0KCgpID0+IHRoaXMuZGlzcGF0Y2hFdmVudChlbCwgJ2lucHV0JyksIDApO1xuXG4gIH1cblxuICBwcml2YXRlIGRpc3BhdGNoRXZlbnQgKGVsLCBldmVudFR5cGUpIHtcblxuICAgIGNvbnN0IGV2ZW50ID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoJ0V2ZW50Jyk7XG4gICAgZXZlbnQuaW5pdEV2ZW50KGV2ZW50VHlwZSwgZmFsc2UsIGZhbHNlKTtcbiAgICBlbC5kaXNwYXRjaEV2ZW50KGV2ZW50KTtcblxuICB9XG5cbn1cbiIsImltcG9ydCB7IE5nTW9kdWxlIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBOZ3hDbGVhdmVEaXJlY3RpdmUgfSBmcm9tICcuL25neC1jbGVhdmUuZGlyZWN0aXZlJztcblxuQE5nTW9kdWxlKHtcbiAgaW1wb3J0czogW10sXG4gIGRlY2xhcmF0aW9uczogW05neENsZWF2ZURpcmVjdGl2ZV0sXG4gIGV4cG9ydHM6IFtOZ3hDbGVhdmVEaXJlY3RpdmVdLFxufSlcbmV4cG9ydCBjbGFzcyBOZ3hDbGVhdmVEaXJlY3RpdmVNb2R1bGUge1xufVxuIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQUE7Ozs7O0lBb0NFLFlBQ1UsWUFDdUM7UUFEdkMsZUFBVSxHQUFWLFVBQVU7UUFDNkIsbUJBQWMsR0FBZCxjQUFjO0tBRTlEOzs7OztRQWxCWSxNQUFNLENBQUUsTUFBVztRQUU5QixJQUFJLENBQUMsT0FBTyxHQUFHLE1BQU0sQ0FBQztRQUV0QixJQUFJLENBQUMsU0FBUyxFQUFFLENBQUM7Ozs7O0lBZ0JuQixRQUFRO1FBRU4sSUFBSSxDQUFDLElBQUksQ0FBQyxjQUFjLEVBQUU7WUFFeEIsT0FBTyxDQUFDLElBQUksQ0FBQyx3R0FBd0csQ0FBQyxDQUFDO1lBRXZILE9BQU87U0FFUjtRQUVELElBQUksSUFBSSxDQUFDLGNBQWMsQ0FBQyxNQUFNLEVBQUU7WUFFOUIsSUFBSSxDQUFDLGNBQWMsR0FBRyxJQUFJLENBQUMsY0FBYyxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBRTdDLElBQUksQ0FBQyxXQUFXLEdBQUcsSUFBSSxDQUFDLGNBQWMsQ0FBQyxVQUFVLENBQUM7WUFDbEQsSUFBSSxDQUFDLGNBQWMsQ0FBQyxVQUFVLEdBQUcsQ0FBQyxLQUFLO2dCQUVyQyxJQUFJLElBQUksQ0FBQyxXQUFXLEVBQUU7b0JBQ3BCLElBQUksQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxjQUFjLEVBQUUsS0FBSyxDQUFDLENBQUM7aUJBQ25EO2dCQUVELElBQUksQ0FBQyxTQUFTLEVBQUUsQ0FBQzthQUVsQixDQUFDO1NBRUg7S0FFRjs7OztJQUVELFdBQVc7UUFFVCxJQUFJLElBQUksQ0FBQyxjQUFjLElBQUksSUFBSSxDQUFDLFdBQVcsRUFBRTtZQUUzQyxJQUFJLENBQUMsY0FBYyxDQUFDLFVBQVUsR0FBRyxJQUFJLENBQUMsV0FBVyxDQUFDO1NBRW5EO1FBRUQsSUFBSSxJQUFJLENBQUMsZUFBZSxFQUFFO1lBRXhCLElBQUksQ0FBQyxlQUFlLENBQUMsT0FBTyxFQUFFLENBQUM7U0FFaEM7S0FFRjs7Ozs7SUFHRCxPQUFPLENBQUUsS0FBYTtRQUVwQixJQUFJLENBQUMsTUFBTSxHQUFHLEtBQUssQ0FBQzs7Ozs7SUFJZCxTQUFTO1FBRWYsSUFBSSxJQUFJLENBQUMsZUFBZSxFQUFFO1lBRXhCLElBQUksQ0FBQyxlQUFlLENBQUMsT0FBTyxFQUFFLENBQUM7U0FFaEM7UUFFRCx1QkFBTSxFQUFFLEdBQUcsSUFBSSxDQUFDLFVBQVUsQ0FBQyxhQUFhLENBQUM7UUFDekMsSUFBSSxDQUFDLGVBQWUsR0FBRyxJQUFJLE1BQU0sQ0FBQyxFQUFFLG9CQUMvQixJQUFJLENBQUMsT0FBTyxJQUNmLGNBQWMsRUFBRSxDQUFDLEVBQUUsTUFBTSxFQUFFO2dCQUN6QixJQUFJLE1BQU0sQ0FBQyxLQUFLLEtBQUssSUFBSSxDQUFDLE1BQU0sRUFBRTtvQkFFaEMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxFQUFFLEVBQUUsT0FBTyxDQUFDLENBQUM7aUJBRWpDO2FBQ0YsSUFDRCxDQUFDOztRQUdILFVBQVUsQ0FBQyxNQUFNLElBQUksQ0FBQyxhQUFhLENBQUMsRUFBRSxFQUFFLE9BQU8sQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDOzs7Ozs7O0lBSS9DLGFBQWEsQ0FBRSxFQUFFLEVBQUUsU0FBUztRQUVsQyx1QkFBTSxLQUFLLEdBQUcsUUFBUSxDQUFDLFdBQVcsQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUM1QyxLQUFLLENBQUMsU0FBUyxDQUFDLFNBQVMsRUFBRSxLQUFLLEVBQUUsS0FBSyxDQUFDLENBQUM7UUFDekMsRUFBRSxDQUFDLGFBQWEsQ0FBQyxLQUFLLENBQUMsQ0FBQzs7OztZQTFHM0IsU0FBUyxTQUFDO2dCQUNULFFBQVEsRUFBRSxnQ0FBZ0M7YUFDM0M7Ozs7WUFqQkMsVUFBVTt3Q0FvQ1AsTUFBTSxTQUFDLGlCQUFpQixjQUFHLFFBQVE7Ozt1QkFoQnJDLEtBQUs7d0JBaUVMLFlBQVksU0FBQyxPQUFPLEVBQUUsQ0FBQyxxQkFBcUIsQ0FBQzs7Ozs7OztBQ3ZGaEQ7OztZQUdDLFFBQVEsU0FBQztnQkFDUixPQUFPLEVBQUUsRUFBRTtnQkFDWCxZQUFZLEVBQUUsQ0FBQyxrQkFBa0IsQ0FBQztnQkFDbEMsT0FBTyxFQUFFLENBQUMsa0JBQWtCLENBQUM7YUFDOUI7Ozs7Ozs7Ozs7Ozs7OzsifQ==