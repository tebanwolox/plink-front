import { __assign } from 'tslib';
import { Directive, ElementRef, HostListener, Inject, Input, Optional, NgModule } from '@angular/core';
import { NG_VALUE_ACCESSOR } from '@angular/forms';
import * as Cleave from 'cleave.js';

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */
var NgxCleaveDirective = /** @class */ (function () {
    function NgxCleaveDirective(elementRef, valueAccessors) {
        this.elementRef = elementRef;
        this.valueAccessors = valueAccessors;
    }
    Object.defineProperty(NgxCleaveDirective.prototype, "cleave", {
        set: /**
         * @param {?} cleave
         * @return {?}
         */
        function (cleave) {
            this._cleave = cleave;
            this.setCleave();
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    NgxCleaveDirective.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        if (!this.valueAccessors) {
            console.warn('Note: The cleave directive should be used with the ngModel, formControl or formControlName directives.');
            return;
        }
        if (this.valueAccessors.length) {
            this._valueAccessor = this.valueAccessors[0];
            this._writeValue = this._valueAccessor.writeValue;
            this._valueAccessor.writeValue = function (value) {
                if (_this._writeValue) {
                    _this._writeValue.call(_this._valueAccessor, value);
                }
                _this.setCleave();
            };
        }
    };
    /**
     * @return {?}
     */
    NgxCleaveDirective.prototype.ngOnDestroy = /**
     * @return {?}
     */
    function () {
        if (this._valueAccessor && this._writeValue) {
            this._valueAccessor.writeValue = this._writeValue;
        }
        if (this._cleaveInstance) {
            this._cleaveInstance.destroy();
        }
    };
    /**
     * @param {?} value
     * @return {?}
     */
    NgxCleaveDirective.prototype.onInput = /**
     * @param {?} value
     * @return {?}
     */
    function (value) {
        this._value = value;
    };
    /**
     * @return {?}
     */
    NgxCleaveDirective.prototype.setCleave = /**
     * @return {?}
     */
    function () {
        var _this = this;
        if (this._cleaveInstance) {
            this._cleaveInstance.destroy();
        }
        var /** @type {?} */ el = this.elementRef.nativeElement;
        this._cleaveInstance = new Cleave(el, __assign({}, this._cleave, { onValueChanged: function (_a) {
                var target = _a.target;
                if (target.value !== _this._value) {
                    _this.dispatchEvent(el, 'input');
                }
            } }));
        // hack for model -> view cleave
        setTimeout(function () { return _this.dispatchEvent(el, 'input'); }, 0);
    };
    /**
     * @param {?} el
     * @param {?} eventType
     * @return {?}
     */
    NgxCleaveDirective.prototype.dispatchEvent = /**
     * @param {?} el
     * @param {?} eventType
     * @return {?}
     */
    function (el, eventType) {
        var /** @type {?} */ event = document.createEvent('Event');
        event.initEvent(eventType, false, false);
        el.dispatchEvent(event);
    };
    NgxCleaveDirective.decorators = [
        { type: Directive, args: [{
                    selector: 'input[cleave],textarea[cleave]',
                },] },
    ];
    /** @nocollapse */
    NgxCleaveDirective.ctorParameters = function () { return [
        { type: ElementRef, },
        { type: Array, decorators: [{ type: Inject, args: [NG_VALUE_ACCESSOR,] }, { type: Optional },] },
    ]; };
    NgxCleaveDirective.propDecorators = {
        "cleave": [{ type: Input },],
        "onInput": [{ type: HostListener, args: ['input', ['$event.target.value'],] },],
    };
    return NgxCleaveDirective;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */
var NgxCleaveDirectiveModule = /** @class */ (function () {
    function NgxCleaveDirectiveModule() {
    }
    NgxCleaveDirectiveModule.decorators = [
        { type: NgModule, args: [{
                    imports: [],
                    declarations: [NgxCleaveDirective],
                    exports: [NgxCleaveDirective],
                },] },
    ];
    return NgxCleaveDirectiveModule;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */

export { NgxCleaveDirective, NgxCleaveDirectiveModule };

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmd4LWNsZWF2ZS1kaXJlY3RpdmUuanMubWFwIiwic291cmNlcyI6WyJuZzovL25neC1jbGVhdmUtZGlyZWN0aXZlL25neC1jbGVhdmUuZGlyZWN0aXZlLnRzIiwibmc6Ly9uZ3gtY2xlYXZlLWRpcmVjdGl2ZS9uZ3gtY2xlYXZlLWRpcmVjdGl2ZS5tb2R1bGUudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgRGlyZWN0aXZlLFxuICBFbGVtZW50UmVmLFxuICBIb3N0TGlzdGVuZXIsXG4gIEluamVjdCxcbiAgSW5wdXQsXG4gIE9uRGVzdHJveSxcbiAgT25Jbml0LFxuICBPcHRpb25hbCxcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQge1xuICBDb250cm9sVmFsdWVBY2Nlc3NvcixcbiAgTkdfVkFMVUVfQUNDRVNTT1IsXG59IGZyb20gJ0Bhbmd1bGFyL2Zvcm1zJztcblxuaW1wb3J0ICogYXMgQ2xlYXZlIGZyb20gJ2NsZWF2ZS5qcyc7XG5cbkBEaXJlY3RpdmUoe1xuICBzZWxlY3RvcjogJ2lucHV0W2NsZWF2ZV0sdGV4dGFyZWFbY2xlYXZlXScsXG59KVxuZXhwb3J0IGNsYXNzIE5neENsZWF2ZURpcmVjdGl2ZSBpbXBsZW1lbnRzIE9uSW5pdCwgT25EZXN0cm95IHtcblxuICBASW5wdXQoKSBzZXQgY2xlYXZlIChjbGVhdmU6IGFueSkge1xuXG4gICAgdGhpcy5fY2xlYXZlID0gY2xlYXZlO1xuXG4gICAgdGhpcy5zZXRDbGVhdmUoKTtcblxuICB9XG5cbiAgcHJpdmF0ZSBfY2xlYXZlOiBhbnk7XG4gIHByaXZhdGUgX2NsZWF2ZUluc3RhbmNlOiBDbGVhdmU7XG4gIHByaXZhdGUgX3ZhbHVlOiBzdHJpbmc7XG4gIHByaXZhdGUgX3ZhbHVlQWNjZXNzb3I6IENvbnRyb2xWYWx1ZUFjY2Vzc29yO1xuICBwcml2YXRlIF93cml0ZVZhbHVlOiAodmFsdWUpID0+IHZvaWQ7XG5cbiAgY29uc3RydWN0b3IgKFxuICAgIHByaXZhdGUgZWxlbWVudFJlZjogRWxlbWVudFJlZixcbiAgICBASW5qZWN0KE5HX1ZBTFVFX0FDQ0VTU09SKSBAT3B0aW9uYWwoKSBwcml2YXRlIHZhbHVlQWNjZXNzb3JzOiBDb250cm9sVmFsdWVBY2Nlc3NvcltdLFxuICApIHtcbiAgfVxuXG4gIG5nT25Jbml0ICgpIHtcblxuICAgIGlmICghdGhpcy52YWx1ZUFjY2Vzc29ycykge1xuXG4gICAgICBjb25zb2xlLndhcm4oJ05vdGU6IFRoZSBjbGVhdmUgZGlyZWN0aXZlIHNob3VsZCBiZSB1c2VkIHdpdGggdGhlIG5nTW9kZWwsIGZvcm1Db250cm9sIG9yIGZvcm1Db250cm9sTmFtZSBkaXJlY3RpdmVzLicpO1xuXG4gICAgICByZXR1cm47XG5cbiAgICB9XG5cbiAgICBpZiAodGhpcy52YWx1ZUFjY2Vzc29ycy5sZW5ndGgpIHtcblxuICAgICAgdGhpcy5fdmFsdWVBY2Nlc3NvciA9IHRoaXMudmFsdWVBY2Nlc3NvcnNbMF07XG5cbiAgICAgIHRoaXMuX3dyaXRlVmFsdWUgPSB0aGlzLl92YWx1ZUFjY2Vzc29yLndyaXRlVmFsdWU7XG4gICAgICB0aGlzLl92YWx1ZUFjY2Vzc29yLndyaXRlVmFsdWUgPSAodmFsdWUpID0+IHtcblxuICAgICAgICBpZiAodGhpcy5fd3JpdGVWYWx1ZSkge1xuICAgICAgICAgIHRoaXMuX3dyaXRlVmFsdWUuY2FsbCh0aGlzLl92YWx1ZUFjY2Vzc29yLCB2YWx1ZSk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnNldENsZWF2ZSgpO1xuXG4gICAgICB9O1xuXG4gICAgfVxuXG4gIH1cblxuICBuZ09uRGVzdHJveSAoKSB7XG5cbiAgICBpZiAodGhpcy5fdmFsdWVBY2Nlc3NvciAmJiB0aGlzLl93cml0ZVZhbHVlKSB7XG5cbiAgICAgIHRoaXMuX3ZhbHVlQWNjZXNzb3Iud3JpdGVWYWx1ZSA9IHRoaXMuX3dyaXRlVmFsdWU7XG5cbiAgICB9XG5cbiAgICBpZiAodGhpcy5fY2xlYXZlSW5zdGFuY2UpIHtcblxuICAgICAgdGhpcy5fY2xlYXZlSW5zdGFuY2UuZGVzdHJveSgpO1xuXG4gICAgfVxuXG4gIH1cblxuICBASG9zdExpc3RlbmVyKCdpbnB1dCcsIFsnJGV2ZW50LnRhcmdldC52YWx1ZSddKVxuICBvbklucHV0ICh2YWx1ZTogc3RyaW5nKTogdm9pZCB7XG5cbiAgICB0aGlzLl92YWx1ZSA9IHZhbHVlO1xuXG4gIH1cblxuICBwcml2YXRlIHNldENsZWF2ZSAoKSB7XG5cbiAgICBpZiAodGhpcy5fY2xlYXZlSW5zdGFuY2UpIHtcblxuICAgICAgdGhpcy5fY2xlYXZlSW5zdGFuY2UuZGVzdHJveSgpO1xuXG4gICAgfVxuXG4gICAgY29uc3QgZWwgPSB0aGlzLmVsZW1lbnRSZWYubmF0aXZlRWxlbWVudDtcbiAgICB0aGlzLl9jbGVhdmVJbnN0YW5jZSA9IG5ldyBDbGVhdmUoZWwsIHtcbiAgICAgIC4uLnRoaXMuX2NsZWF2ZSxcbiAgICAgIG9uVmFsdWVDaGFuZ2VkOiAoeyB0YXJnZXQgfSkgPT4ge1xuICAgICAgICBpZiAodGFyZ2V0LnZhbHVlICE9PSB0aGlzLl92YWx1ZSkge1xuXG4gICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KGVsLCAnaW5wdXQnKTtcblxuICAgICAgICB9XG4gICAgICB9LFxuICAgIH0pO1xuXG4gICAgLy8gaGFjayBmb3IgbW9kZWwgLT4gdmlldyBjbGVhdmVcbiAgICBzZXRUaW1lb3V0KCgpID0+IHRoaXMuZGlzcGF0Y2hFdmVudChlbCwgJ2lucHV0JyksIDApO1xuXG4gIH1cblxuICBwcml2YXRlIGRpc3BhdGNoRXZlbnQgKGVsLCBldmVudFR5cGUpIHtcblxuICAgIGNvbnN0IGV2ZW50ID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoJ0V2ZW50Jyk7XG4gICAgZXZlbnQuaW5pdEV2ZW50KGV2ZW50VHlwZSwgZmFsc2UsIGZhbHNlKTtcbiAgICBlbC5kaXNwYXRjaEV2ZW50KGV2ZW50KTtcblxuICB9XG5cbn1cbiIsImltcG9ydCB7IE5nTW9kdWxlIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBOZ3hDbGVhdmVEaXJlY3RpdmUgfSBmcm9tICcuL25neC1jbGVhdmUuZGlyZWN0aXZlJztcblxuQE5nTW9kdWxlKHtcbiAgaW1wb3J0czogW10sXG4gIGRlY2xhcmF0aW9uczogW05neENsZWF2ZURpcmVjdGl2ZV0sXG4gIGV4cG9ydHM6IFtOZ3hDbGVhdmVEaXJlY3RpdmVdLFxufSlcbmV4cG9ydCBjbGFzcyBOZ3hDbGVhdmVEaXJlY3RpdmVNb2R1bGUge1xufVxuIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7SUFvQ0UsNEJBQ1UsWUFDdUM7UUFEdkMsZUFBVSxHQUFWLFVBQVU7UUFDNkIsbUJBQWMsR0FBZCxjQUFjO0tBRTlEOzBCQWxCWSxzQ0FBTTs7Ozs7a0JBQUUsTUFBVztZQUU5QixJQUFJLENBQUMsT0FBTyxHQUFHLE1BQU0sQ0FBQztZQUV0QixJQUFJLENBQUMsU0FBUyxFQUFFLENBQUM7Ozs7Ozs7O0lBZ0JuQixxQ0FBUTs7O0lBQVI7UUFBQSxpQkEyQkM7UUF6QkMsSUFBSSxDQUFDLElBQUksQ0FBQyxjQUFjLEVBQUU7WUFFeEIsT0FBTyxDQUFDLElBQUksQ0FBQyx3R0FBd0csQ0FBQyxDQUFDO1lBRXZILE9BQU87U0FFUjtRQUVELElBQUksSUFBSSxDQUFDLGNBQWMsQ0FBQyxNQUFNLEVBQUU7WUFFOUIsSUFBSSxDQUFDLGNBQWMsR0FBRyxJQUFJLENBQUMsY0FBYyxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBRTdDLElBQUksQ0FBQyxXQUFXLEdBQUcsSUFBSSxDQUFDLGNBQWMsQ0FBQyxVQUFVLENBQUM7WUFDbEQsSUFBSSxDQUFDLGNBQWMsQ0FBQyxVQUFVLEdBQUcsVUFBQyxLQUFLO2dCQUVyQyxJQUFJLEtBQUksQ0FBQyxXQUFXLEVBQUU7b0JBQ3BCLEtBQUksQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLEtBQUksQ0FBQyxjQUFjLEVBQUUsS0FBSyxDQUFDLENBQUM7aUJBQ25EO2dCQUVELEtBQUksQ0FBQyxTQUFTLEVBQUUsQ0FBQzthQUVsQixDQUFDO1NBRUg7S0FFRjs7OztJQUVELHdDQUFXOzs7SUFBWDtRQUVFLElBQUksSUFBSSxDQUFDLGNBQWMsSUFBSSxJQUFJLENBQUMsV0FBVyxFQUFFO1lBRTNDLElBQUksQ0FBQyxjQUFjLENBQUMsVUFBVSxHQUFHLElBQUksQ0FBQyxXQUFXLENBQUM7U0FFbkQ7UUFFRCxJQUFJLElBQUksQ0FBQyxlQUFlLEVBQUU7WUFFeEIsSUFBSSxDQUFDLGVBQWUsQ0FBQyxPQUFPLEVBQUUsQ0FBQztTQUVoQztLQUVGOzs7OztJQUdELG9DQUFPOzs7O2NBQUUsS0FBYTtRQUVwQixJQUFJLENBQUMsTUFBTSxHQUFHLEtBQUssQ0FBQzs7Ozs7SUFJZCxzQ0FBUzs7Ozs7UUFFZixJQUFJLElBQUksQ0FBQyxlQUFlLEVBQUU7WUFFeEIsSUFBSSxDQUFDLGVBQWUsQ0FBQyxPQUFPLEVBQUUsQ0FBQztTQUVoQztRQUVELHFCQUFNLEVBQUUsR0FBRyxJQUFJLENBQUMsVUFBVSxDQUFDLGFBQWEsQ0FBQztRQUN6QyxJQUFJLENBQUMsZUFBZSxHQUFHLElBQUksTUFBTSxDQUFDLEVBQUUsZUFDL0IsSUFBSSxDQUFDLE9BQU8sSUFDZixjQUFjLEVBQUUsVUFBQyxFQUFVO29CQUFSLGtCQUFNO2dCQUN2QixJQUFJLE1BQU0sQ0FBQyxLQUFLLEtBQUssS0FBSSxDQUFDLE1BQU0sRUFBRTtvQkFFaEMsS0FBSSxDQUFDLGFBQWEsQ0FBQyxFQUFFLEVBQUUsT0FBTyxDQUFDLENBQUM7aUJBRWpDO2FBQ0YsSUFDRCxDQUFDOztRQUdILFVBQVUsQ0FBQyxjQUFNLE9BQUEsS0FBSSxDQUFDLGFBQWEsQ0FBQyxFQUFFLEVBQUUsT0FBTyxDQUFDLEdBQUEsRUFBRSxDQUFDLENBQUMsQ0FBQzs7Ozs7OztJQUkvQywwQ0FBYTs7Ozs7Y0FBRSxFQUFFLEVBQUUsU0FBUztRQUVsQyxxQkFBTSxLQUFLLEdBQUcsUUFBUSxDQUFDLFdBQVcsQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUM1QyxLQUFLLENBQUMsU0FBUyxDQUFDLFNBQVMsRUFBRSxLQUFLLEVBQUUsS0FBSyxDQUFDLENBQUM7UUFDekMsRUFBRSxDQUFDLGFBQWEsQ0FBQyxLQUFLLENBQUMsQ0FBQzs7O2dCQTFHM0IsU0FBUyxTQUFDO29CQUNULFFBQVEsRUFBRSxnQ0FBZ0M7aUJBQzNDOzs7O2dCQWpCQyxVQUFVOzRDQW9DUCxNQUFNLFNBQUMsaUJBQWlCLGNBQUcsUUFBUTs7OzJCQWhCckMsS0FBSzs0QkFpRUwsWUFBWSxTQUFDLE9BQU8sRUFBRSxDQUFDLHFCQUFxQixDQUFDOzs2QkF2RmhEOzs7Ozs7O0FDQUE7Ozs7Z0JBR0MsUUFBUSxTQUFDO29CQUNSLE9BQU8sRUFBRSxFQUFFO29CQUNYLFlBQVksRUFBRSxDQUFDLGtCQUFrQixDQUFDO29CQUNsQyxPQUFPLEVBQUUsQ0FBQyxrQkFBa0IsQ0FBQztpQkFDOUI7O21DQVBEOzs7Ozs7Ozs7Ozs7Ozs7In0=